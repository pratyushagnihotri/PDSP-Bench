{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from 'axios';\nimport * as d3 from 'd3';\nexport default {\n  name: 'MLDataVis',\n  data() {\n    return {\n      selected: [],\n      showCompareDialog: false,\n      url: process.env.VUE_APP_URL,\n      selected_file: null,\n      list_of_files: [],\n      list_of_selected_options: {},\n      list_of_options: [],\n      selected_query: null,\n      list_of_queries: ['Query Types', 'Tuple Width', 'Event Rate', 'Window Duration', 'Window Length', 'Amount of Workers', 'Parallelism Category'],\n      array_of_individual_user_selections: [],\n      array_of_compare_user_selection: [],\n      graphs: []\n    };\n  },\n  computed: {\n    snackbar: {\n      get() {\n        return this.$store.state.snackbar;\n      },\n      set(value) {\n        this.$store.commit('setSnackbar', value);\n      }\n    },\n    isBtnDisabled() {\n      return this.chosen_query_metrics === null && this.chosen_operator_metrics === null && this.query_option === null;\n    }\n  },\n  methods: {\n    mapParameter(item) {\n      if (item == \"predictions_benchmarking_queries.csv\") {\n        return \"Queries\";\n      } else if (item == \"predictions_unseen_cluster_size.csv\") {\n        return \"Cluster Size\";\n      } else if (item == \"predictions_unseen_event_rates.csv\") {\n        return \"Event Rates\";\n      } else if (item == \"predictions_unseen_hardware.csv\") {\n        return \"Hardware\";\n      } else if (item == \"predictions_unseen_test_query_template.csv\") {\n        return \"Test Query Template\";\n      } else if (item == \"predictions_unseen_tuple_widths.csv\") {\n        return \"Tuple Widths\";\n      } else if (item == \"predictions_unseen_window_durations.csv\") {\n        return \"Window Durations\";\n      } else if (item == \"predictions_unseen_window_lengths.csv\") {\n        return \"Window Lengths\";\n      } else {\n        return item;\n      }\n    },\n    mapValue(item) {\n      if (item == \"enumeration_strategy\") {\n        return \"Enumeration Strategy\";\n      } else if (item == \"model_template_name\") {\n        return \"Model Template Name\";\n      } else if (item == \"evaluation_metric\") {\n        return \"Evaluation Metric\";\n      } else if (item == \"test_template_name\") {\n        return \"Test Template Name\";\n      } else if (item == \"amount_of_workers\") {\n        return \"Amount of Workers\";\n      } else if (item == \"unseen\") {\n        return \"Unseen\";\n      } else if (item == \"event_rate\") {\n        return \"Event Rate\";\n      } else if (item == \"hardware_configuration\") {\n        return \"Hardware Configuration\";\n      } else if (item == \"tuple_width\") {\n        return \"Tuple Width\";\n      } else if (item == \"window_duration\") {\n        return \"Window Duration\";\n      } else if (item == \"window_length\") {\n        return \"Window Length\";\n      } else {\n        return item;\n      }\n    },\n    async showComparisonOptions() {\n      this.showCompareDialog = true;\n    },\n    async finishCompareInputs() {\n      this.array_of_compare_user_selection.push(this.selected);\n      this.showCompareDialog = false;\n      await axios.post(this.url + ':8000/report/getCompareGraphDataInference', this.selected).then(async resp => {\n        await resp.data;\n        console.log(\"data from backend for comparison plot\");\n        console.log(resp.data);\n        var container = \"#comparechartContainer\" + (this.array_of_compare_user_selection.length - 1);\n        var title = resp.data.file;\n        this.plotClusterHistogram(container, title, resp.data[\"values\"], \"Quantile\", \"Q-Error\", resp.data[\"clusters\"]);\n        return;\n      });\n    },\n    async refresh() {\n      await axios.get(this.url + \":8000/report/getInferenceOptions\").then(resp => {\n        this.list_of_files = JSON.parse(resp.data);\n      });\n    },\n    async onSelectFile() {\n      console.log(\"Selected file: \", this.selected_file);\n      this.list_of_selected_options = {};\n      this.array_of_compare_user_selection = [];\n      this.selected = [];\n      await axios.post(this.url + \":8000/report/getInferenceOptions\", {\n        \"file\": this.selected_file\n      }).then(resp => {\n        console.log(resp);\n        this.list_of_options = JSON.parse(resp.data);\n      });\n    },\n    async onSelectQuery() {\n      this.list_of_active_query_options = this.list_of_query_options[this.selected_query];\n      this.selected_query_option = null;\n    },\n    async plotIndividualGraph() {\n      let form_data = {\n        ...this.list_of_selected_options\n      };\n      form_data['file'] = this.selected_file;\n      //form_data['query'] = this.selected_query;\n      //form_data['query_option'] = this.selected_query_option;\n      //form_data['enumeration_strategy'] = this.selected_enumeration_strategy;\n      //form_data['test_data'] = this.selected_test_data;\n      //form_data['metric'] = this.selected_metric;\n      //form_data['test_template'] = this.selected_test_template;\n\n      this.array_of_individual_user_selections.push(form_data);\n      console.log(this.array_of_individual_user_selections);\n      await axios.post(this.url + ':8000/report/getIndividualInferenceGraphData', form_data).then(async resp => {\n        await resp.data;\n        var data = JSON.parse(resp.data);\n        var container = \"#chartContainer\" + (this.array_of_individual_user_selections.length - 1);\n        var chartTitle = data.file;\n        var chartSubtitle = data.title;\n        var yLabel = \"Q-Error\" + (data.average ? ' (average)' : '');\n        this.plotHistogram(container, chartTitle, chartSubtitle, data.values, \"Quantile\", yLabel);\n      });\n    },\n    plotHistogram(container, title, subtitle, data, x_axis_name, y_axis_name) {\n      let maxValue = Number.NEGATIVE_INFINITY;\n      for (const key in data) {\n        const value = parseFloat(data[key]);\n        maxValue = Math.max(maxValue, value);\n      }\n      maxValue = Math.ceil(maxValue);\n      console.log('The maximum value is:', maxValue);\n      const margin = {\n        top: 50,\n        right: 50,\n        bottom: 100,\n        left: 50\n      };\n      const width = 480 - margin.left - margin.right;\n      const height = 400 - margin.top - margin.bottom;\n      let svg = d3.select(container).select('svg');\n\n      // Create a new SVG element if not already present\n      svg = d3.select(container).append('svg').attr('width', width + margin.right + margin.right + margin.right + margin.right).attr('height', height + margin.bottom + margin.bottom + margin.bottom).append('g').attr('transform', `translate(${2 * margin.left}, ${margin.top})`);\n      svg.append(\"text\").attr(\"x\", width / 2).attr(\"y\", 0 - margin.top / 2).attr(\"text-anchor\", \"middle\").style(\"font-size\", \"16px\").style(\"fill\", \"white\").attr(\"dy\", -5).text(title);\n      svg.append(\"text\").attr(\"x\", width / 2).attr(\"y\", 0 - margin.top / 2).attr(\"text-anchor\", \"middle\").style(\"font-size\", \"16px\").style(\"fill\", \"white\").attr(\"dy\", 15).text(subtitle);\n      const xScale = d3.scaleBand().range([0, width]).padding(0.1).domain(Object.keys(data));\n      //d3.max(Object.values(data))\n      const yScale = d3.scaleLinear().range([height, 0]).domain([0, 1.5 * maxValue]).nice();\n      svg.append(\"g\").attr(\"transform\", `translate(0, ${height})`).call(d3.axisBottom(xScale).tickSizeOuter(0)).selectAll(\"text\").style(\"fill\", \"white\").attr(\"transform\", \"rotate(-45)\") // Rotate the x-axis labels by -45 degrees\n      .style(\"text-anchor\", \"end\");\n\n      // Add Y Axis\n      svg.append(\"g\").call(d3.axisLeft(yScale).tickSizeOuter(0)).selectAll(\"text\").style(\"fill\", \"white\");\n\n      // Adding x and y gridlines\n      svg.append(\"g\").attr(\"class\", \"grid\").attr(\"transform\", \"translate(0,\" + height + \")\").call(d3.axisBottom(xScale).tickSize(-height).tickFormat(\"\"));\n      svg.append(\"g\").attr(\"class\", \"grid\").call(d3.axisLeft(yScale).tickSize(-width).tickFormat(\"\"));\n\n      // Add the x axis label\n      svg.append(\"text\").attr(\"class\", \"x-axis-label\").attr(\"x\", width / 2).attr(\"y\", height + margin.bottom + 40).attr(\"text-anchor\", \"middle\").style(\"fill\", \"#FFFDD0\").attr(\"dy\", \"0.5em\").text(x_axis_name);\n\n      // Add the y axis label\n      svg.append(\"text\").attr(\"class\", \"y-axis-label\").attr(\"x\", 0 - height / 2).attr(\"y\", 0 - margin.left - margin.left / 2).attr(\"text-anchor\", \"middle\").attr(\"transform\", \"rotate(-90)\").attr(\"dy\", \"0.5em\").style(\"fill\", \"#FFFDD0\").text(y_axis_name);\n      const colorScale = d3.scaleOrdinal().domain(Object.keys(data)).range([\"#ffb3ba\", \"#baffc9\", \"#ffffba\", \"#bae1ff\", \"#9467bd\", \"#8c564b\", \"#e377c2\"]);\n      svg.selectAll(\".bar\").data(Object.entries(data)).enter().append(\"rect\").attr(\"class\", \"bar\") // Added class \"bar\" to the rect elements for easier selection\n      .attr(\"x\", d => xScale(d[0])) // Changed x position to use the xScale with the key of the data object\n      .attr(\"y\", d => yScale(d[1])) // Changed y position to use the yScale with the value of the data object\n      .attr(\"width\", xScale.bandwidth()) // Changed width to use the bandwidth of the xScale\n      .attr(\"height\", d => height - yScale(d[1])) // Changed height to be the difference between the height and the yScale value\n      .style(\"fill\", i => colorScale(i));\n      svg.selectAll(\".label\").data(Object.entries(data)).enter().append(\"text\").attr(\"class\", \"label\").attr(\"id\", d => `label-${d[0]}`) // Set unique ID for each label\n      .attr(\"x\", d => xScale(d[0]) + xScale.bandwidth() / 2).attr(\"y\", d => yScale(d[1]) - 25).attr(\"text-anchor\", \"middle\").style(\"fill\", \"white\").text(d => parseFloat(d[1]).toFixed(2)).style(\"visibility\", \"visible\");\n    },\n    // data = {\"group1\": {\"cluster1\": 1}}\n    plotClusterHistogram(container, title, data, x_axis_name, y_axis_name, clusters) {\n      let maxValue = Number.NEGATIVE_INFINITY;\n      for (const key in data) {\n        const value = parseFloat(data[key]);\n        maxValue = Math.max(maxValue, value);\n      }\n      maxValue = Math.ceil(maxValue);\n      console.log('The maximum value is:', maxValue);\n      const margin = {\n        top: 50,\n        right: 50,\n        bottom: 100,\n        left: 50\n      };\n      const width = 480 - margin.left - margin.right;\n      const height = 400 - margin.top - margin.bottom;\n      let svg = d3.select(container).select('svg');\n\n      // Create a new SVG element if not already present\n      svg = d3.select(container).append('svg').attr('width', width + margin.right + margin.right + margin.right + margin.right).attr('height', height + margin.bottom + margin.bottom + margin.bottom).append('g').attr('transform', `translate(${2 * margin.left}, ${margin.top})`);\n      svg.append(\"text\").attr(\"x\", width / 2).attr(\"y\", 0 - margin.top / 2).attr(\"text-anchor\", \"middle\").style(\"font-size\", \"16px\").style(\"fill\", \"white\").attr(\"dy\", 10).text(title);\n      const xScale = d3.scaleBand().range([0, width]).padding(0.1).domain(Object.keys(data));\n      //d3.max(Object.values(data))\n      const yScale = d3.scaleLinear().range([height, 0]).domain([0, 1.5 * maxValue]).nice();\n      svg.append(\"g\").attr(\"transform\", `translate(0, ${height})`).call(d3.axisBottom(xScale).tickSizeOuter(0)).selectAll(\"text\").style(\"fill\", \"white\").attr(\"transform\", \"rotate(-45)\") // Rotate the x-axis labels by -45 degrees\n      .style(\"text-anchor\", \"end\");\n\n      // Add Y Axis\n      svg.append(\"g\").call(d3.axisLeft(yScale).tickSizeOuter(0)).selectAll(\"text\").style(\"fill\", \"white\");\n\n      // Adding x and y gridlines\n      svg.append(\"g\").attr(\"class\", \"grid\").attr(\"transform\", \"translate(0,\" + height + \")\").call(d3.axisBottom(xScale).tickSize(-height).tickFormat(\"\"));\n      svg.append(\"g\").attr(\"class\", \"grid\").call(d3.axisLeft(yScale).tickSize(-width).tickFormat(\"\"));\n\n      // Add the x axis label\n      svg.append(\"text\").attr(\"class\", \"x-axis-label\").attr(\"x\", width / 2).attr(\"y\", height + margin.bottom + 40).attr(\"text-anchor\", \"middle\").style(\"fill\", \"#FFFDD0\").attr(\"dy\", \"0.5em\").text(x_axis_name);\n\n      // Add the y axis label\n      svg.append(\"text\").attr(\"class\", \"y-axis-label\").attr(\"x\", 0 - height / 2).attr(\"y\", 0 - margin.left - margin.left / 2).attr(\"text-anchor\", \"middle\").attr(\"transform\", \"rotate(-90)\").attr(\"dy\", \"0.5em\").style(\"fill\", \"#FFFDD0\").text(y_axis_name);\n      const colorScale = d3.scaleOrdinal().domain(Object.keys(data)).range([\"#ffb3ba\", \"#baffc9\", \"#ffffba\", \"#bae1ff\", \"#9467bd\", \"#8c564b\", \"#e377c2\"].flatMap(i => Array.from({\n        length: clusters.length\n      }).fill(i)));\n      svg.selectAll(\".bar\").data(Object.entries(data)).enter().append(\"rect\").attr(\"class\", \"bar\") // Added class \"bar\" to the rect elements for easier selection\n      .attr(\"x\", d => xScale(d[0])) // Changed x position to use the xScale with the key of the data object\n      .attr(\"y\", d => yScale(d[1])) // Changed y position to use the yScale with the value of the data object\n      .attr(\"width\", xScale.bandwidth()) // Changed width to use the bandwidth of the xScale\n      .attr(\"height\", d => height - yScale(d[1])) // Changed height to be the difference between the height and the yScale value\n      .style(\"fill\", i => colorScale(i));\n      svg.selectAll(\".label\").data(Object.entries(data)).enter().append(\"text\").attr(\"class\", \"label\").attr(\"id\", d => `label-${d[0]}`) // Set unique ID for each label\n      .attr(\"x\", d => xScale(d[0]) + xScale.bandwidth() / 2).attr(\"y\", d => yScale(d[1]) - 25).attr(\"text-anchor\", \"middle\").style(\"fill\", \"white\").text(d => parseFloat(d[1]).toFixed(2)).style(\"visibility\", \"visible\");\n      var legendContainer = svg.append(\"g\") // This creates a container for the legend\n      .attr(\"class\", \"legend-container\")\n      //.attr(\"transform\", \"translate(\" + (width + margin.right - 40) + \",\" + (margin.top - 60) + \")\")\n      .attr(\"transform\", \"translate(5,5)\").style(\"overflow-y\", \"auto\") // Enable vertical scrolling\n      .attr(\"height\", 100);\n      var legend = legendContainer.selectAll(\".legend\").data(clusters).enter().append(\"g\").attr(\"class\", \"legend\").attr(\"transform\", function (d, i) {\n        return \"translate(0,\" + i * 15 + \")\";\n      }).style(\"fill\", \"#FFFDD0\");\n      legend.append(\"text\").attr(\"x\", 15).attr(\"y\", 5).attr(\"dy\", \".35em\").style(\"text-anchor\", \"start\").style(\"fill\", \"#FFFDD0\").style(\"font-size\", \"10px\").text(function (d, i) {\n        return i + \": \" + d;\n      });\n    },\n    drawLineGraph(container_id, title, data, x_axis_name, y_axis_name, max_value) {\n      var margin = {\n          top: 50,\n          right: 50,\n          bottom: 50,\n          left: 50\n        },\n        width = 480 - margin.left - margin.right,\n        height = 400 - margin.top - margin.bottom;\n\n      // Create the SVG container\n      var svg = d3.select(container_id).append(\"svg\").style(\"background-color\", \"black\").attr(\"width\", width + margin.left + margin.right + margin.right + margin.right).attr(\"height\", height + margin.bottom + margin.bottom + margin.bottom).append(\"g\").attr(\"transform\", \"translate(\" + 2 * margin.left + \",\" + margin.top + \")\");\n\n      // Set up the x and y scales\n      var xScale = d3.scaleTime().range([0, width]);\n      var yScale = d3.scaleLinear().range([height, 0]);\n\n      // Set up the x and y axes\n      var xAxis = d3.axisBottom(xScale).tickSizeOuter(0);\n      var yAxis = d3.axisLeft(yScale).tickSizeOuter(0);\n\n      // Update the x and y domains based on the data\n      var allData = [];\n      data.forEach(function (lineData) {\n        allData = allData.concat(lineData.values);\n      });\n      console.log(allData);\n      xScale.domain(d3.extent(allData, function (d) {\n        return new Date(d[0] * 1000);\n      }));\n      yScale.domain([0, 2 * max_value]);\n      //yScale.domain([0, d3.max(allData, function(d) { return d[1]; })]);\n      // Add the x and y axes to the SVG container\n      svg.append(\"g\").attr(\"class\", \"x-axis\").attr(\"transform\", \"translate(0,\" + height + \")\").style(\"fill\", \"#FFFDD0\").call(xAxis);\n      svg.append(\"g\").attr(\"class\", \"y-axis\").style(\"fill\", \"#FFFDD0\").call(yAxis);\n\n      //Add the x and y gridlines\n      svg.append(\"g\").attr(\"class\", \"grid\").attr(\"transform\", \"translate(0,\" + height + \")\").call(d3.axisBottom(xScale).tickSize(-height).tickFormat(\"\"));\n      svg.append(\"g\").attr(\"class\", \"grid\").call(d3.axisLeft(yScale).tickSize(-width).tickFormat(\"\"));\n\n      // Add the title to the graph\n      svg.append(\"text\").attr(\"class\", \"title\").attr(\"x\", width / 2).attr(\"y\", 0 - margin.top / 2).attr(\"text-anchor\", \"middle\").style(\"fill\", \"#FFFDD0\").text(title);\n\n      // Add the x axis label\n      svg.append(\"text\").attr(\"class\", \"x-axis-label\").attr(\"x\", width / 2).attr(\"y\", height + margin.bottom - 10).attr(\"text-anchor\", \"middle\").style(\"fill\", \"#FFFDD0\").text(x_axis_name);\n\n      // Add the y axis label\n      svg.append(\"text\").attr(\"class\", \"y-axis-label\").attr(\"x\", 0 - height / 2).attr(\"y\", 0 - margin.left - margin.left / 2 - 10).attr(\"text-anchor\", \"middle\").attr(\"transform\", \"rotate(-90)\").attr(\"dy\", \"0.5em\").style(\"fill\", \"#FFFDD0\").text(y_axis_name);\n      svg.selectAll(\".x-axis text\").style(\"fill\", \"#FFFDD0\");\n      svg.selectAll(\".y-axis text\").attr(\"dx\", \"0.5em\").style(\"fill\", \"#FFFDD0\");\n\n      // Define a color scale for lines\n      var contrastColors = [\"#FF5733\", \"#2ECC71\", \"#3498DB\", \"#E74C3C\", \"#1ABC9C\", \"#F39C12\", \"#9B59B6\", \"#27AE60\"];\n      var colorSelected = [];\n      // Loop through the data and draw the line for each line in the graph\n      data.forEach(function (lineData, i) {\n        var line = d3.line().x(function (d) {\n          return xScale(new Date(d[0] * 1000));\n        }).y(function (d) {\n          return yScale(d[1]);\n        });\n        //var color_line = \"#\" + Math.floor(Math.random()*16777215).toString(16)\n        var color_line = contrastColors[i];\n        colorSelected.push(color_line);\n        svg.append(\"path\").datum(lineData.values).attr(\"class\", \"line\").attr(\"d\", line).style(\"stroke\", color_line) // Set the stroke color based on index\n        .style(\"fill\", \"none\");\n      });\n      var legendContainer = svg.append(\"g\") // This creates a container for the legend\n      .attr(\"class\", \"legend-container\").attr(\"transform\", \"translate(\" + (width + margin.right - 40) + \",\" + (margin.top - 60) + \")\").style(\"overflow-y\", \"auto\") // Enable vertical scrolling\n      .attr(\"height\", height - margin.top - margin.bottom).attr(\"height\", height);\n      var legend = legendContainer.selectAll(\".legend\").data(data.slice(0, 21)).enter().append(\"g\").attr(\"class\", \"legend\").attr(\"transform\", function (d, i) {\n        return \"translate(0,\" + i * 15 + \")\";\n      }).style(\"fill\", \"#FFFDD0\");\n      legend.append(\"rect\").attr(\"x\", 0).attr(\"width\", 5).attr(\"height\", 5).style(\"fill\", function (d, i) {\n        return colorSelected[i];\n      });\n      legend.append(\"text\").attr(\"x\", 15).attr(\"y\", 5).attr(\"dy\", \".35em\").style(\"text-anchor\", \"start\").style(\"fill\", \"#FFFDD0\").style(\"font-size\", \"10px\").text(function (d) {\n        return d.metric[\"host\"].slice(0, 5);\n      });\n    }\n  },\n  async mounted() {\n    this.refresh();\n  }\n};","map":{"version":3,"mappings":";AAoIA;AACA;AAEA;EACAA;EACAC;IACA;MACAC;MACAC;MACAC;MAEAC;MACAC;MACAC;MACAC;MACAC;MACAC,kBACA,eACA,eACA,cACA,mBACA,iBACA,qBACA,uBACA;MAEAC;MACAC;MACAC;IACA;EACA;EACAC;IACAC;MACAC;QACA;MACA;MACAC;QACA;MACA;IACA;IACAC;MACA;IACA;EACA;EACAC;IACAC;MACA;QACA;MACA;QACA;MACA;QACA;MACA;QACA;MACA;QACA;MACA;QACA;MACA;QACA;MACA;QACA;MACA;QACA;MACA;IACA;IACAC;MACA;QACA;MACA;QACA;MACA;QACA;MACA;QACA;MACA;QACA;MACA;QACA;MACA;QACA;MACA;QACA;MACA;QACA;MACA;QACA;MACA;QACA;MACA;QACA;MACA;IACA;IACA;MACA;IACA;IACA;MACA;MACA;MAEA,YACAC,4EACAC;QACA;QACAC;QACAA;QACA;QACA;QAEA;QACA;MACA;IACA;IACA;MACA,YACAR,mDACAO;QACA;MACA;IACA;IACA;MACAC;MACA;MACA;MACA;MACA,YACAF;QAAA;MAAA,GACAC;QACAC;QACA;MACA;IACA;IACA;MACA;MACA;IACA;IACA;MACA;QAAA;MAAA;MACAC;MACA;MACA;MACA;MACA;MACA;MACA;;MAEA;MACAD;MAEA,YACAF,2EACAC;QACA;QACA;QAEA;QACA;QACA;QACA;QACA;MACA;IACA;IACAG;MACA;MAEA;QACA;QACAC;MACA;MAEAA;MACAH;MAGA;QAAAI;QAAAC;QAAAC;QAAAC;MAAA;MACA;MACA;MAEA;;MAEA;MACAC,SACAC,kBACAC,cACAC,iFACAA,uEACAD,YACAC;MAEAH,mBACAG,qBACAA,8BACAA,8BACAC,2BACAA,uBACAD,eACAE;MAEAL,mBACAG,qBACAA,8BACAA,8BACAC,2BACAA,uBACAD,eACAE;MAEA,kBACAC,YACAC,kBACAC,aACAC;MACA;MACA,kBACAC,cACAH,mBACAE,4BACAE;MAEAX,gBACAG,6CACAS,2BACAC,kBACAC,kBACAV,uBACAD;MAAA,CACAC;;MAEA;MACAJ,gBACAY,yBACAC,kBACAC,kBACAV;;MAEA;MACAJ,gBACAG,sBACAA,iDACAS,2BACAG,kBACAC,eACA;MAEAhB,gBACAG,sBACAS,yBACAG,iBACAC,eACA;;MAEA;MACAhB,mBACAG,8BACAA,qBACAA,uCACAA,8BACAC,yBACAD,oBACAE;;MAEA;MACAL,mBACAG,8BACAA,0BACAA,6CACAA,8BACAA,iCACAA,oBACAC,yBACAC;MAEA,qCACAI,0BACAF;MAGAP,sBACA/B,2BACAgD,uBACAd;MAAA,CACAA;MAAA,CACAA;MAAA,CACAA;MAAA,CACAA;MAAA,CACAC;MACAJ,wBACA/B,2BACAgD,uBACAd,uBACAA;MAAA,CACAA,sDACAA,kCACAA,8BACAC,uBACAC,uCACAD;IACA;IAEA;IACAc;MACA;MAEA;QACA;QACAvB;MACA;MAEAA;MACAH;MAEA;QAAAI;QAAAC;QAAAC;QAAAC;MAAA;MACA;MACA;MAEA;;MAEA;MACAC,SACAC,kBACAC,cACAC,iFACAA,uEACAD,YACAC;MAEAH,mBACAG,qBACAA,8BACAA,8BACAC,2BACAA,uBACAD,eACAE;MAEA,kBACAC,YACAC,kBACAC,aACAC;MACA;MACA,kBACAC,cACAH,mBACAE,4BACAE;MAEAX,gBACAG,6CACAS,2BACAC,kBACAC,kBACAV,uBACAD;MAAA,CACAC;;MAEA;MACAJ,gBACAY,yBACAC,kBACAC,kBACAV;;MAEA;MACAJ,gBACAG,sBACAA,iDACAS,2BACAG,kBACAC,eACA;MAEAhB,gBACAG,sBACAS,yBACAG,iBACAC,eACA;;MAEA;MACAhB,mBACAG,8BACAA,qBACAA,uCACAA,8BACAC,yBACAD,oBACAE;;MAEA;MACAL,mBACAG,8BACAA,0BACAA,6CACAA,8BACAA,iCACAA,oBACAC,yBACAC;MAEA,qCACAI,0BACAF,oFACAY;QAAAC;MAAA;MAEApB,sBACA/B,2BACAgD,uBACAd;MAAA,CACAA;MAAA,CACAA;MAAA,CACAA;MAAA,CACAA;MAAA,CACAC;MACAJ,wBACA/B,2BACAgD,uBACAd,uBACAA;MAAA,CACAA,sDACAA,kCACAA,8BACAC,uBACAC,uCACAD;MAEA;MAAA,CACAD;MACA;MAAA,CACAA,oCACAC;MAAA,CACAD;MAEA,kDACAlC,eACAgD,oBACAd,wBACAA;QAAA;MAAA,GACAC;MAEAiB,sBACAlB,cACAA,aACAA,oBACAC,8BACAA,yBACAA,2BACAC;QAAA;MAAA;IACA;IAEAiB;MACA;UAAA1B;UAAAC;UAAAC;UAAAC;QAAA;QACAwB;QACAC;;MAEA;MACA,kCACAtB,cACAE,mCACAD,gFACAA,uEACAD,YACAC;;MAEA;MACA,4BACAI;MACA,8BACAA;;MAEA;MACA;MACA;;MAEA;MACA;MACAtC;QACAwD;MACA;MAEAjC;MAEAkC;QAAA;MAAA;MACAC;MACA;MACA;MACA3B,gBACAG,wBACAA,iDACAC,yBAEAQ;MACAZ,gBACAG,wBACAC,yBAEAQ;;MAEA;MACAZ,gBACAG,sBACAA,iDACAS,2BACAG,kBACAC,eACA;MAEAhB,gBACAG,sBACAS,yBACAG,iBACAC,eACA;;MAEA;MACAhB,mBACAG,uBACAA,qBACAA,8BACAA,8BACAC,yBACAC;;MAEA;MACAL,mBACAG,8BACAA,qBACAA,uCACAA,8BACAC,yBACAC;;MAEA;MACAL,mBACAG,8BACAA,0BACAA,kDACAA,8BACAA,iCACAA,oBACAC,yBACAC;MACAL,8BACAI;MACAJ,8BACAG,oBACAC;;MAEA;MACA;MAEA;MACA;MACAnC;QACA,qBACA2D;UAAA;QAAA,GACAC;UAAA;QAAA;QACA;QACA;QACAC;QACA9B,mBACA+B,uBACA5B,sBACAA,gBACAC;QAAA,CACAA;MAGA;MAGA;MAAA,CACAD,kCACAA,8FACAC;MAAA,CACAD,oDACAA;MAEA,kDACAlC,wBACAgD,oBACAd,wBACAA;QAAA;MAAA,GACAC;MAEAiB,sBACAlB,aACAA,iBACAA,kBACAC;QAAA;MAAA;MAEAiB,sBACAlB,cACAA,aACAA,oBACAC,8BACAA,yBACAA,2BACAC;QAAA;MAAA;IAEA;EACA;EACA;IACA;EACA;AACA","names":["name","data","selected","showCompareDialog","url","selected_file","list_of_files","list_of_selected_options","list_of_options","selected_query","list_of_queries","array_of_individual_user_selections","array_of_compare_user_selection","graphs","computed","snackbar","get","set","isBtnDisabled","methods","mapParameter","mapValue","post","then","console","form_data","plotHistogram","maxValue","top","right","bottom","left","svg","select","append","attr","style","text","scaleBand","range","padding","domain","scaleLinear","nice","call","tickSizeOuter","selectAll","tickSize","tickFormat","enter","plotClusterHistogram","flatMap","length","legend","drawLineGraph","width","height","allData","xScale","yScale","x","y","colorSelected","datum"],"sourceRoot":"src/views/dashboard","sources":["MlDataVis.vue"],"sourcesContent":["<template>\n    <div>\n            <v-card class=\"my-6 pa-0\" color=\"white\" elevation=\"24px\">\n                <v-card-title>\n                    <v-sheet color=\"primary\" elevation=\"24\"\n                        class=\"justify-center mt-n12 pl-16 pr-16 pt-6 pb-6 rounded  white--text \">\n                        <h3>ML Data Visualization</h3>\n                    </v-sheet>\n                </v-card-title>\n                <v-card-subtitle class=\"text-right\">\n                    <v-btn v-if=\"array_of_individual_user_selections.length>=2\" color=\"primary\" class=\"ma-4\" elevation=\"3\"\n                        @click=\"showComparisonOptions()\">\n                        <v-icon>mdi-plus</v-icon><b>Compare</b>\n                    </v-btn>\n                </v-card-subtitle>\n                <v-card-text>\n                    <v-form ref=\"formingMetrics\">\n                        <v-row class=\"mt-6\">\n                            <v-col cols=\"3\">\n                                <v-select background-color=\"white\" color=\"black\" v-model=\"selected_file\"\n                                    :items=\"list_of_files\" label=\"Select Inference Parameter\"\n                                    outlined @change=\"onSelectFile\">\n                                    <template v-slot:selection=\"item\">\n                                        {{ mapParameter(item.item) }}\n                                    </template>\n                                    <template v-slot:item=\"item\">\n                                        {{ mapParameter(item.item) }}\n                                    </template>\n                                </v-select>\n                            </v-col>\n                        </v-row>\n                        <!-- TODO: show dynamic input fields based on options -->\n                        <v-row class=\"mt-6\">\n                            <v-col cols=\"3\" v-for=\"(options, name) in list_of_options\" :key=\"name\">\n                                <v-select background-color=\"white\"\n                                          color=\"black\"\n                                          v-model=\"list_of_selected_options[name]\"\n                                          :items=\"options\"\n                                          :label=\"mapValue(name)\"\n                                          outlined>\n                                </v-select>\n                            </v-col>\n                        </v-row>\n                    </v-form>\n                </v-card-text>\n\n                <v-card-actions>\n                    <v-spacer></v-spacer>\n                    <v-btn :disabled=\"isBtnDisabled\" color=\"primary\" class=\"ma-4\" elevation=\"3\"\n                        @click=\"plotIndividualGraph()\">\n                        <v-icon>mdi-plus</v-icon><b>Plot Graph</b>\n                    </v-btn>\n                    <!-- <v-btn :disabled=\"isBtnDisabled\" color=\"primary\" class=\"ma-4\" elevation=\"3\"\n                        @click=\"showComparisonOptions()\">\n                        <v-icon>mdi-plus</v-icon><b>Compare</b>\n                    </v-btn> -->\n                </v-card-actions>\n            </v-card>\n\n        <!-- <v-card>\n            <div id=\"chartContainer18\"></div>\n        </v-card> -->\n        <v-card class=\"my-12 pa-0\" color=\"white\" elevation=\"24\">\n            <v-card-title>\n                <v-sheet color=\"primary\" elevation=\"24\"\n                        class=\"justify-center mt-n12 pl-16 pr-16 pt-6 pb-6 rounded  white--text \">\n                    <h3>Individual charts</h3>\n                </v-sheet>\n            </v-card-title>\n            <v-card-text>\n                <v-row>\n                    <v-col v-for=\"chart,index in array_of_individual_user_selections\" :key=\"index\">\n                        <div class=\"pa-3\" :id=\"'chartContainer'+index\"></div>\n                    </v-col>\n                </v-row>\n            </v-card-text>\n        </v-card> \n        <v-card class=\"my-12 pa-0\" color=\"white\" elevation=\"24\">\n            <v-card-title>\n                <v-sheet color=\"primary\" elevation=\"24\"\n                        class=\"justify-center mt-n12 pl-16 pr-16 pt-6 pb-6 rounded  white--text \">\n                    <h3>Compare charts</h3>\n                </v-sheet>\n            </v-card-title>\n            <v-card-text>\n                <v-row>\n                    <v-col v-for=\"chart,index in array_of_compare_user_selection\" :key=\"index\">\n                        <div class =\"pa-3\" :id=\"'comparechartContainer'+index\"></div>\n                    </v-col>\n                </v-row>\n            </v-card-text>\n        </v-card>\n\n        <v-dialog \n            v-model=\"showCompareDialog\"\n            persistent\n            max-width=\"500\"\n            class=\"primary\">\n            <v-card>\n                <v-card-title>\n                    <span class=\"text-h5\">Compare Metrics</span>\n                </v-card-title>\n                <!-- <v-card-subtitle>\n                    {{ selected }}\n                </v-card-subtitle> -->\n                <v-card-text> \n                    <div v-for=\"selectInput,index in array_of_individual_user_selections\" :key=\"index\">\n                        <v-checkbox v-model=\"selected\" :value=\"selectInput\"\n                            :disabled=\"selectInput.file != selected_file\">\n                            <template v-slot:label>\n                                <v-card class=\"w-full\" dark>\n                                    <v-card-text>\n                                        <span v-for=\"(value, key) in selectInput\" :key=\"key\">\n                                            {{ key }}: {{ value }}<br />\n                                        </span>\n                                        <span v-if=\"selectInput.file != selected_file\" style=\"color: red\">Mixing parameters is not possible</span>\n                                    </v-card-text>\n                                </v-card>\n                            </template>\n                        </v-checkbox>\n                    </div>\n                </v-card-text>\n                <v-card-actions>\n                    <v-spacer />\n                    <v-btn class=\"error mr-2\" small @click=\"showCompareDialog=false\"> Close </v-btn>\n                    <v-btn class=\"success mr-2\" small @click=\"finishCompareInputs() \"> Finish </v-btn>\n                </v-card-actions>\n            </v-card>\n        </v-dialog>\n    </div>\n</template>\n<script>\nimport axios from 'axios';\nimport * as d3 from 'd3';\n\nexport default {\n    name: 'MLDataVis',\n    data() {\n        return {\n            selected: [],\n            showCompareDialog: false,\n            url: process.env.VUE_APP_URL,\n\n            selected_file: null,\n            list_of_files: [],\n            list_of_selected_options: {},\n            list_of_options: [],\n            selected_query: null,\n            list_of_queries: [\n                'Query Types',\n                'Tuple Width',\n                'Event Rate',\n                'Window Duration',\n                'Window Length',\n                'Amount of Workers',\n                'Parallelism Category',\n            ],\n\n            array_of_individual_user_selections: [],\n            array_of_compare_user_selection:[],\n            graphs: [],\n        }\n    },\n    computed: {\n        snackbar: {\n            get() {\n                return this.$store.state.snackbar;\n            },\n            set(value) {\n                this.$store.commit('setSnackbar', value);\n            },\n        },\n        isBtnDisabled() {\n            return this.chosen_query_metrics === null && this.chosen_operator_metrics === null && this.query_option === null;\n        }\n    },\n    methods: {\n        mapParameter(item) {\n            if (item == \"predictions_benchmarking_queries.csv\") {\n                return \"Queries\";\n            } else if (item == \"predictions_unseen_cluster_size.csv\") {\n                return \"Cluster Size\";\n            } else if (item == \"predictions_unseen_event_rates.csv\") {\n                return \"Event Rates\";\n            } else if (item == \"predictions_unseen_hardware.csv\") {\n                return \"Hardware\";\n            } else if (item == \"predictions_unseen_test_query_template.csv\") {\n                return \"Test Query Template\";\n            } else if (item == \"predictions_unseen_tuple_widths.csv\") {\n                return \"Tuple Widths\";\n            } else if (item == \"predictions_unseen_window_durations.csv\") {\n                return \"Window Durations\";\n            } else if (item == \"predictions_unseen_window_lengths.csv\") {\n                return \"Window Lengths\";\n            } else {\n                return item;\n            }\n        },\n        mapValue(item) {\n            if (item == \"enumeration_strategy\") {\n                return \"Enumeration Strategy\";\n            } else if (item == \"model_template_name\") {\n                return \"Model Template Name\";\n            } else if (item == \"evaluation_metric\") {\n                return \"Evaluation Metric\";\n            } else if (item == \"test_template_name\") {\n                return \"Test Template Name\";\n            } else if (item == \"amount_of_workers\") {\n                return \"Amount of Workers\";\n            } else if (item == \"unseen\") {\n                return \"Unseen\";\n            } else if (item == \"event_rate\") {\n                return \"Event Rate\";\n            } else if (item == \"hardware_configuration\") {\n                return \"Hardware Configuration\";\n            } else if (item == \"tuple_width\") {\n                return \"Tuple Width\";\n            } else if (item == \"window_duration\") {\n                return \"Window Duration\";\n            } else if (item == \"window_length\") {\n                return \"Window Length\";\n            } else {\n                return item;\n            }\n        },\n        async showComparisonOptions(){\n            this.showCompareDialog = true;\n        },\n        async finishCompareInputs() {\n            this.array_of_compare_user_selection.push(this.selected)\n            this.showCompareDialog=false;\n\n            await axios\n                .post(this.url + ':8000/report/getCompareGraphDataInference', this.selected)\n                .then(async (resp) => {\n                    await resp.data;\n                    console.log(\"data from backend for comparison plot\");\n                    console.log(resp.data);\n                    var container = \"#comparechartContainer\" + (this.array_of_compare_user_selection.length-1)\n                    var title = resp.data.file;\n\n                    this.plotClusterHistogram(container, title, resp.data[\"values\"], \"Quantile\", \"Q-Error\", resp.data[\"clusters\"])\n                    return\n                })\n        },\n        async refresh() {\n            await axios\n                .get(this.url + \":8000/report/getInferenceOptions\")\n                .then((resp) => {\n                    this.list_of_files = JSON.parse(resp.data);\n                })\n        },\n        async onSelectFile() {\n            console.log(\"Selected file: \", this.selected_file);\n            this.list_of_selected_options = {}\n            this.array_of_compare_user_selection = [];\n            this.selected = [];\n            await axios\n                .post(this.url + \":8000/report/getInferenceOptions\", {\"file\": this.selected_file})\n                .then((resp) => {\n                    console.log(resp)\n                    this.list_of_options = JSON.parse(resp.data)\n                })\n        },\n        async onSelectQuery() {\n            this.list_of_active_query_options = this.list_of_query_options[this.selected_query];\n            this.selected_query_option = null;\n        },\n        async plotIndividualGraph() {\n            let form_data = {...this.list_of_selected_options};\n            form_data['file'] = this.selected_file;\n            //form_data['query'] = this.selected_query;\n            //form_data['query_option'] = this.selected_query_option;\n            //form_data['enumeration_strategy'] = this.selected_enumeration_strategy;\n            //form_data['test_data'] = this.selected_test_data;\n            //form_data['metric'] = this.selected_metric;\n            //form_data['test_template'] = this.selected_test_template;\n\n            this.array_of_individual_user_selections.push(form_data)\n            console.log(this.array_of_individual_user_selections)\n\n            await axios\n                .post(this.url + ':8000/report/getIndividualInferenceGraphData', form_data)\n                .then(async (resp) => {\n                    await resp.data;\n                    var data = JSON.parse(resp.data);\n\n                    var container = \"#chartContainer\" + (this.array_of_individual_user_selections.length-1);\n                    var chartTitle = data.file;\n                    var chartSubtitle = data.title;\n                    var yLabel = \"Q-Error\" + (data.average ? ' (average)' : '')\n                    this.plotHistogram(container, chartTitle, chartSubtitle, data.values, \"Quantile\", yLabel);\n                });\n        },\n        plotHistogram(container, title, subtitle, data, x_axis_name, y_axis_name) {\n            let maxValue = Number.NEGATIVE_INFINITY;\n\n            for (const key in data) {\n            const value = parseFloat(data[key]);\n            maxValue = Math.max(maxValue, value);\n            }\n\n            maxValue = Math.ceil(maxValue);\n            console.log('The maximum value is:', maxValue);\n\n\n            const margin = { top: 50, right: 50, bottom: 100, left: 50 };\n            const width = 480 - margin.left - margin.right;\n            const height = 400 - margin.top - margin.bottom;\n\n            let svg = d3.select(container).select('svg');\n\n            // Create a new SVG element if not already present\n            svg = d3\n              .select(container)\n              .append('svg')\n              .attr('width', width + margin.right + margin.right + margin.right + margin.right)\n              .attr('height', height + margin.bottom + margin.bottom + margin.bottom)\n              .append('g')\n              .attr('transform', `translate(${2 * margin.left}, ${margin.top})`);\n\n            svg.append(\"text\")\n              .attr(\"x\", width / 2)\n              .attr(\"y\", 0 - (margin.top / 2))\n              .attr(\"text-anchor\", \"middle\")\n              .style(\"font-size\", \"16px\")\n              .style(\"fill\", \"white\")\n              .attr(\"dy\", -5)\n              .text(title);\n\n            svg.append(\"text\")\n              .attr(\"x\", width / 2)\n              .attr(\"y\", 0 - (margin.top / 2))\n              .attr(\"text-anchor\", \"middle\")\n              .style(\"font-size\", \"16px\")\n              .style(\"fill\", \"white\")\n              .attr(\"dy\", 15)\n              .text(subtitle);\n\n            const xScale = d3\n              .scaleBand()\n              .range([0, width])\n              .padding(0.1)\n              .domain(Object.keys(data));\n            //d3.max(Object.values(data))\n            const yScale = d3\n              .scaleLinear()\n              .range([height, 0])\n              .domain([0, 1.5 * maxValue])\n              .nice();\n\n            svg.append(\"g\")\n              .attr(\"transform\", `translate(0, ${height})`)\n              .call(d3.axisBottom(xScale)\n                .tickSizeOuter(0))\n              .selectAll(\"text\")\n              .style(\"fill\", \"white\")\n              .attr(\"transform\", \"rotate(-45)\") // Rotate the x-axis labels by -45 degrees\n              .style(\"text-anchor\", \"end\");\n\n            // Add Y Axis\n            svg.append(\"g\")\n              .call(d3.axisLeft(yScale)\n                .tickSizeOuter(0))\n              .selectAll(\"text\")\n              .style(\"fill\", \"white\");\n\n            // Adding x and y gridlines\n            svg.append(\"g\")\n              .attr(\"class\", \"grid\")\n              .attr(\"transform\", \"translate(0,\" + height + \")\")\n              .call(d3.axisBottom(xScale)\n              .tickSize(-height)\n              .tickFormat(\"\")\n            );\n\n            svg.append(\"g\")\n              .attr(\"class\", \"grid\")\n              .call(d3.axisLeft(yScale)\n              .tickSize(-width)\n              .tickFormat(\"\")\n            );\n\n            // Add the x axis label\n            svg.append(\"text\")\n              .attr(\"class\", \"x-axis-label\")\n              .attr(\"x\", width / 2)\n              .attr(\"y\", height + margin.bottom + 40)\n              .attr(\"text-anchor\", \"middle\")\n              .style(\"fill\", \"#FFFDD0\")\n              .attr(\"dy\", \"0.5em\")\n              .text(x_axis_name);\n\n            // Add the y axis label\n            svg.append(\"text\")\n              .attr(\"class\", \"y-axis-label\")\n              .attr(\"x\", 0 - (height / 2))\n              .attr(\"y\", 0 - margin.left - (margin.left / 2))\n              .attr(\"text-anchor\", \"middle\")\n              .attr(\"transform\", \"rotate(-90)\")\n              .attr(\"dy\", \"0.5em\")\n              .style(\"fill\", \"#FFFDD0\")\n              .text(y_axis_name);\n\n            const colorScale = d3.scaleOrdinal()\n             .domain(Object.keys(data))\n             .range([\"#ffb3ba\", \"#baffc9\", \"#ffffba\", \"#bae1ff\", \"#9467bd\", \"#8c564b\", \"#e377c2\"]);\n\n\n            svg.selectAll(\".bar\")\n              .data(Object.entries(data))\n              .enter().append(\"rect\")\n              .attr(\"class\", \"bar\") // Added class \"bar\" to the rect elements for easier selection\n              .attr(\"x\", d => xScale(d[0])) // Changed x position to use the xScale with the key of the data object\n              .attr(\"y\", d => yScale(d[1])) // Changed y position to use the yScale with the value of the data object\n              .attr(\"width\", xScale.bandwidth()) // Changed width to use the bandwidth of the xScale\n              .attr(\"height\", d => height - yScale(d[1])) // Changed height to be the difference between the height and the yScale value\n              .style(\"fill\", (i) => colorScale(i));\n            svg.selectAll(\".label\")\n              .data(Object.entries(data))\n              .enter().append(\"text\")\n              .attr(\"class\", \"label\")\n              .attr(\"id\", d => `label-${d[0]}`) // Set unique ID for each label\n              .attr(\"x\", d => xScale(d[0]) + xScale.bandwidth() / 2)\n              .attr(\"y\", d => yScale(d[1]) - 25)\n              .attr(\"text-anchor\", \"middle\")\n              .style(\"fill\", \"white\")\n              .text(d => parseFloat(d[1]).toFixed(2))\n              .style(\"visibility\", \"visible\");\n            },\n\n        // data = {\"group1\": {\"cluster1\": 1}}\n        plotClusterHistogram(container, title, data, x_axis_name, y_axis_name, clusters) {\n            let maxValue = Number.NEGATIVE_INFINITY;\n\n            for (const key in data) {\n                const value = parseFloat(data[key]);\n                maxValue = Math.max(maxValue, value);\n            }\n\n            maxValue = Math.ceil(maxValue);\n            console.log('The maximum value is:', maxValue);\n\n            const margin = { top: 50, right: 50, bottom: 100, left: 50 };\n            const width = 480 - margin.left - margin.right;\n            const height = 400 - margin.top - margin.bottom;\n\n            let svg = d3.select(container).select('svg');\n\n            // Create a new SVG element if not already present\n            svg = d3\n              .select(container)\n              .append('svg')\n              .attr('width', width + margin.right + margin.right + margin.right + margin.right)\n              .attr('height', height + margin.bottom + margin.bottom + margin.bottom)\n              .append('g')\n              .attr('transform', `translate(${2 * margin.left}, ${margin.top})`);\n\n            svg.append(\"text\")\n              .attr(\"x\", width / 2)\n              .attr(\"y\", 0 - (margin.top / 2))\n              .attr(\"text-anchor\", \"middle\")\n              .style(\"font-size\", \"16px\")\n              .style(\"fill\", \"white\")\n              .attr(\"dy\", 10)\n              .text(title);\n\n            const xScale = d3\n              .scaleBand()\n              .range([0, width])\n              .padding(0.1)\n              .domain(Object.keys(data));\n            //d3.max(Object.values(data))\n            const yScale = d3\n              .scaleLinear()\n              .range([height, 0])\n              .domain([0, 1.5 * maxValue])\n              .nice();\n\n            svg.append(\"g\")\n              .attr(\"transform\", `translate(0, ${height})`)\n              .call(d3.axisBottom(xScale)\n                .tickSizeOuter(0))\n              .selectAll(\"text\")\n              .style(\"fill\", \"white\")\n              .attr(\"transform\", \"rotate(-45)\") // Rotate the x-axis labels by -45 degrees\n              .style(\"text-anchor\", \"end\");\n\n            // Add Y Axis\n            svg.append(\"g\")\n              .call(d3.axisLeft(yScale)\n                .tickSizeOuter(0))\n              .selectAll(\"text\")\n              .style(\"fill\", \"white\");\n\n            // Adding x and y gridlines\n            svg.append(\"g\")\n              .attr(\"class\", \"grid\")\n              .attr(\"transform\", \"translate(0,\" + height + \")\")\n              .call(d3.axisBottom(xScale)\n              .tickSize(-height)\n              .tickFormat(\"\")\n            );\n\n            svg.append(\"g\")\n              .attr(\"class\", \"grid\")\n              .call(d3.axisLeft(yScale)\n              .tickSize(-width)\n              .tickFormat(\"\")\n            );\n\n            // Add the x axis label\n            svg.append(\"text\")\n              .attr(\"class\", \"x-axis-label\")\n              .attr(\"x\", width / 2)\n              .attr(\"y\", height + margin.bottom + 40)\n              .attr(\"text-anchor\", \"middle\")\n              .style(\"fill\", \"#FFFDD0\")\n              .attr(\"dy\", \"0.5em\")\n              .text(x_axis_name);\n\n            // Add the y axis label\n            svg.append(\"text\")\n              .attr(\"class\", \"y-axis-label\")\n              .attr(\"x\", 0 - (height / 2))\n              .attr(\"y\", 0 - margin.left - (margin.left / 2))\n              .attr(\"text-anchor\", \"middle\")\n              .attr(\"transform\", \"rotate(-90)\")\n              .attr(\"dy\", \"0.5em\")\n              .style(\"fill\", \"#FFFDD0\")\n              .text(y_axis_name);\n\n            const colorScale = d3.scaleOrdinal()\n             .domain(Object.keys(data))\n             .range([\"#ffb3ba\", \"#baffc9\", \"#ffffba\", \"#bae1ff\", \"#9467bd\", \"#8c564b\", \"#e377c2\"]\n                 .flatMap(i => Array.from({ length: clusters.length }).fill(i)));\n\n            svg.selectAll(\".bar\")\n                .data(Object.entries(data))\n                .enter().append(\"rect\")\n                .attr(\"class\", \"bar\") // Added class \"bar\" to the rect elements for easier selection\n                .attr(\"x\", d => xScale(d[0])) // Changed x position to use the xScale with the key of the data object\n                .attr(\"y\", d => yScale(d[1])) // Changed y position to use the yScale with the value of the data object\n                .attr(\"width\", xScale.bandwidth()) // Changed width to use the bandwidth of the xScale\n                .attr(\"height\", d => height - yScale(d[1])) // Changed height to be the difference between the height and the yScale value\n                .style(\"fill\", (i) => colorScale(i));\n            svg.selectAll(\".label\")\n                .data(Object.entries(data))\n                .enter().append(\"text\")\n                .attr(\"class\", \"label\")\n                .attr(\"id\", d => `label-${d[0]}`) // Set unique ID for each label\n                .attr(\"x\", d => xScale(d[0]) + xScale.bandwidth() / 2)\n                .attr(\"y\", d => yScale(d[1]) - 25)\n                .attr(\"text-anchor\", \"middle\")\n                .style(\"fill\", \"white\")\n                .text(d => parseFloat(d[1]).toFixed(2))\n                .style(\"visibility\", \"visible\");\n\n            var legendContainer = svg.append(\"g\") // This creates a container for the legend\n                .attr(\"class\", \"legend-container\")\n                //.attr(\"transform\", \"translate(\" + (width + margin.right - 40) + \",\" + (margin.top - 60) + \")\")\n                .attr(\"transform\", \"translate(5,5)\")\n                .style(\"overflow-y\", \"auto\") // Enable vertical scrolling\n                .attr(\"height\", 100);\n\n            var legend = legendContainer.selectAll(\".legend\")\n                .data(clusters)\n                .enter().append(\"g\")\n                .attr(\"class\", \"legend\")\n                .attr(\"transform\", function(d, i) { return \"translate(0,\" + i * 15 + \")\"; })\n                .style(\"fill\", \"#FFFDD0\");\n\n            legend.append(\"text\")\n                .attr(\"x\", 15)\n                .attr(\"y\", 5)\n                .attr(\"dy\", \".35em\")\n                .style(\"text-anchor\", \"start\")\n                .style(\"fill\", \"#FFFDD0\")\n                .style(\"font-size\", \"10px\")\n                .text(function(d, i) { return i + \": \" + d; });\n        },\n\n        drawLineGraph(container_id, title, data, x_axis_name, y_axis_name, max_value) {\n            var margin = {top: 50, right: 50, bottom: 50, left: 50},\n            width = 480 - margin.left - margin.right,\n            height = 400 - margin.top - margin.bottom;\n\n            // Create the SVG container\n            var svg = d3.select(container_id)\n              .append(\"svg\")\n              .style(\"background-color\", \"black\")\n              .attr(\"width\", width + margin.left + margin.right + margin.right + margin.right)\n              .attr(\"height\", height + margin.bottom + margin.bottom + margin.bottom)\n              .append(\"g\")\n              .attr(\"transform\", \"translate(\" + (2 * margin.left) + \",\" + margin.top + \")\");\n\n            // Set up the x and y scales\n            var xScale = d3.scaleTime()\n              .range([0, width]);\n            var yScale = d3.scaleLinear()\n              .range([height, 0]);\n\n            // Set up the x and y axes\n            var xAxis = d3.axisBottom(xScale).tickSizeOuter(0);\n            var yAxis = d3.axisLeft(yScale).tickSizeOuter(0);\n\n            // Update the x and y domains based on the data\n            var allData = [];\n            data.forEach(function(lineData) {\n              allData = allData.concat(lineData.values);\n            });\n\n            console.log(allData);\n            \n            xScale.domain(d3.extent(allData, function(d) { return new Date(d[0] * 1000); }));\n            yScale.domain([0, 2 * (max_value)]);\n            //yScale.domain([0, d3.max(allData, function(d) { return d[1]; })]);\n            // Add the x and y axes to the SVG container\n            svg.append(\"g\")\n              .attr(\"class\", \"x-axis\")\n              .attr(\"transform\", \"translate(0,\" + height + \")\")\n              .style(\"fill\", \"#FFFDD0\")\n\n              .call(xAxis);\n            svg.append(\"g\")\n              .attr(\"class\", \"y-axis\")\n              .style(\"fill\", \"#FFFDD0\")\n\n              .call(yAxis);\n        \n            //Add the x and y gridlines\n            svg.append(\"g\")\n              .attr(\"class\", \"grid\")\n              .attr(\"transform\", \"translate(0,\" + height + \")\")\n              .call(d3.axisBottom(xScale)\n                .tickSize(-height)\n                .tickFormat(\"\")\n              );\n\n            svg.append(\"g\")\n              .attr(\"class\", \"grid\")\n              .call(d3.axisLeft(yScale)\n                .tickSize(-width)\n                .tickFormat(\"\")\n              );\n\n              // Add the title to the graph\n              svg.append(\"text\")\n                .attr(\"class\", \"title\")\n                .attr(\"x\", (width / 2))\n                .attr(\"y\", 0 - (margin.top / 2))\n                .attr(\"text-anchor\", \"middle\")\n                .style(\"fill\", \"#FFFDD0\") \n                .text(title);\n\n              // Add the x axis label\n              svg.append(\"text\")\n                .attr(\"class\", \"x-axis-label\")\n                .attr(\"x\", width / 2)\n                .attr(\"y\", height + margin.bottom - 10)\n                .attr(\"text-anchor\", \"middle\")\n                .style(\"fill\", \"#FFFDD0\") \n                .text(x_axis_name);\n\n              // Add the y axis label\n              svg.append(\"text\")\n                .attr(\"class\", \"y-axis-label\")\n                .attr(\"x\", 0 - (height / 2))\n                .attr(\"y\", 0 - margin.left - (margin.left / 2)- 10)\n                .attr(\"text-anchor\", \"middle\")\n                .attr(\"transform\", \"rotate(-90)\")\n                .attr(\"dy\", \"0.5em\")\n                .style(\"fill\", \"#FFFDD0\") \n                .text(y_axis_name);\n              svg.selectAll(\".x-axis text\")      \n                .style(\"fill\", \"#FFFDD0\");\n              svg.selectAll(\".y-axis text\")\n                .attr(\"dx\", \"0.5em\")\n                .style(\"fill\", \"#FFFDD0\");\n          \n                // Define a color scale for lines\n                var contrastColors = [\"#FF5733\", \"#2ECC71\", \"#3498DB\", \"#E74C3C\", \"#1ABC9C\", \"#F39C12\", \"#9B59B6\", \"#27AE60\"];\n\n                var colorSelected = []\n                // Loop through the data and draw the line for each line in the graph\n                data.forEach(function(lineData, i) {\n                  var line = d3.line()\n                    .x(function(d) { return xScale(new Date(d[0] * 1000)); })\n                  .y(function(d) { return yScale(d[1]); });\n                //var color_line = \"#\" + Math.floor(Math.random()*16777215).toString(16)\n                var color_line = contrastColors[i];\n                colorSelected.push(color_line)\n                svg.append(\"path\")\n                  .datum(lineData.values)\n                  .attr(\"class\", \"line\")\n                  .attr(\"d\", line)\n                  .style(\"stroke\", color_line) // Set the stroke color based on index\n                  .style(\"fill\", \"none\");\n\n                  \n              });\n             \n\n                var legendContainer = svg.append(\"g\") // This creates a container for the legend\n    .attr(\"class\", \"legend-container\")\n    .attr(\"transform\", \"translate(\" + (width + margin.right - 40) + \",\" + (margin.top - 60) + \")\")\n    .style(\"overflow-y\", \"auto\") // Enable vertical scrolling\n    .attr(\"height\", height - margin.top - margin.bottom)\n    .attr(\"height\", height);\n\nvar legend = legendContainer.selectAll(\".legend\")\n    .data(data.slice(0, 21))\n    .enter().append(\"g\")\n    .attr(\"class\", \"legend\")\n    .attr(\"transform\", function(d, i) { return \"translate(0,\" + i * 15 + \")\"; })\n    .style(\"fill\", \"#FFFDD0\");\n\nlegend.append(\"rect\")\n    .attr(\"x\", 0)\n    .attr(\"width\", 5)\n    .attr(\"height\", 5)\n    .style(\"fill\", function(d, i) { return colorSelected[i]; });\n\nlegend.append(\"text\")\n    .attr(\"x\", 15)\n    .attr(\"y\", 5)\n    .attr(\"dy\", \".35em\")\n    .style(\"text-anchor\", \"start\")\n    .style(\"fill\", \"#FFFDD0\")\n    .style(\"font-size\", \"10px\")\n    .text(function(d) { return (d.metric[\"host\"]).slice(0 , 5); });\n\n        },\n    },  \n    async mounted() {\n        this.refresh();\n    }\n}\n</script>\n<style>\n.legend{\n  padding: 2%;\n  max-height: 150px;\n  overflow-x: scroll;\n  border: 1px solid blue;\n}\n\n</style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}